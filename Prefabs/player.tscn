[gd_scene format=3 uid="uid://qg2ty2uh3qkc"]

[ext_resource type="Script" uid="uid://b2gp21vwxpq3q" path="res://Scripts/player.gd" id="1_4flbx"]
[ext_resource type="PackedScene" uid="uid://dnu0i17s3hiy1" path="res://Assets/blend files/charecter.blend" id="2_5wxv7"]
[ext_resource type="PackedScene" uid="uid://c2dqhqkbj57sy" path="res://Prefabs/game_hud.tscn" id="2_knrd4"]
[ext_resource type="PackedScene" uid="uid://bvnwhjvlfis5t" path="res://Assets/blend files/face mask.blend" id="4_2nftw"]
[ext_resource type="Script" uid="uid://b10jw5gwb4mnt" path="res://Scripts/WristRadar.gd" id="4_knrd4"]
[ext_resource type="AudioStream" uid="uid://b5mk2lnki2yy6" path="res://Assets/SFX/FootstepUnderwater.ogg" id="6_hck1p"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_5wxv7"]
radius = 0.3
height = 1.75

[sub_resource type="Gradient" id="Gradient_2nftw"]
offsets = PackedFloat32Array(0.62091506, 1)

[sub_resource type="FastNoiseLite" id="FastNoiseLite_knrd4"]
noise_type = 2
frequency = 0.0295
fractal_type = 0

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_hck1p"]
noise = SubResource("FastNoiseLite_knrd4")
color_ramp = SubResource("Gradient_2nftw")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_juxdh"]
transparency = 1
albedo_color = Color(1, 1, 1, 0.23529412)
albedo_texture = SubResource("NoiseTexture2D_hck1p")
stencil_flags = 2

[sub_resource type="PlaneMesh" id="PlaneMesh_y5hcb"]

[sub_resource type="ViewportTexture" id="ViewportTexture_knrd4"]
viewport_path = NodePath("Radar/wrist UI")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_2nftw"]
resource_local_to_scene = true
albedo_texture = SubResource("ViewportTexture_knrd4")

[sub_resource type="JointLimitationCone3D" id="JointLimitationCone3D_knrd4"]
angle = 2.0943952

[sub_resource type="JointLimitationCone3D" id="JointLimitationCone3D_hck1p"]
angle = 2.3561945

[sub_resource type="JointLimitationCone3D" id="JointLimitationCone3D_juxdh"]
angle = 2.3561945

[sub_resource type="AnimationNodeAdd2" id="AnimationNodeAdd2_hck1p"]

[sub_resource type="AnimationNodeAdd2" id="AnimationNodeAdd2_2nftw"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_hck1p"]
animation = &"pull up radar"
play_mode = 1

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_knrd4"]
animation = &"holding controls"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_juxdh"]
animation = &"pull up radar"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_4qbli"]
animation = &"pressing buttons"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_08u7w"]
animation = &"walking"

[sub_resource type="AnimationNodeTransition" id="AnimationNodeTransition_4qbli"]
input_0/name = "state_0"
input_0/auto_advance = false
input_0/break_loop_at_end = false
input_0/reset = true
input_1/name = "state_1"
input_1/auto_advance = false
input_1/break_loop_at_end = false
input_1/reset = true
input_2/name = "state_2"
input_2/auto_advance = false
input_2/break_loop_at_end = false
input_2/reset = true

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_hck1p"]
graph_offset = Vector2(-124.82663, 29.048302)
nodes/output/position = Vector2(580, 60)
"nodes/Animation 6/node" = SubResource("AnimationNodeAnimation_4qbli")
"nodes/Animation 6/position" = Vector2(-380, -40)
"nodes/Animation 3/node" = SubResource("AnimationNodeAnimation_hck1p")
"nodes/Animation 3/position" = Vector2(-120, 320)
nodes/Add2/node = SubResource("AnimationNodeAdd2_2nftw")
nodes/Add2/position = Vector2(-140, -140)
nodes/Transition/node = SubResource("AnimationNodeTransition_4qbli")
nodes/Transition/position = Vector2(120, 40)
"nodes/Animation 4/node" = SubResource("AnimationNodeAnimation_knrd4")
"nodes/Animation 4/position" = Vector2(-360, -200)
"nodes/Animation 5/node" = SubResource("AnimationNodeAnimation_juxdh")
"nodes/Animation 5/position" = Vector2(-140, 100)
nodes/Animation/node = SubResource("AnimationNodeAnimation_08u7w")
nodes/Animation/position = Vector2(240, 280)
"nodes/Add2 2/node" = SubResource("AnimationNodeAdd2_hck1p")
"nodes/Add2 2/position" = Vector2(420, 40)
node_connections = [&"output", 0, &"Add2 2", &"Add2", 0, &"Animation 4", &"Add2", 1, &"Animation 6", &"Transition", 0, &"Add2", &"Transition", 1, &"Animation 5", &"Transition", 2, &"Animation 3", &"Add2 2", 0, &"Transition", &"Add2 2", 1, &"Animation"]

[node name="player" type="CharacterBody3D" unique_id=1252446106 node_paths=PackedStringArray("camera_3d", "head", "skeleton", "gem_hold_spot") groups=["player"]]
collision_layer = 4
collision_mask = 9
script = ExtResource("1_4flbx")
camera_3d = NodePath("head/Camera3D")
head = NodePath("head")
skeleton = NodePath("charecter/Armature/Skeleton3D")
gem_hold_spot = NodePath("head/Camera3D/Gem holding")

[node name="game hud" parent="." unique_id=1530883497 instance=ExtResource("2_knrd4")]

[node name="CollisionShape3D" type="CollisionShape3D" parent="." unique_id=1670405471]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.87538993, 0)
shape = SubResource("CapsuleShape3D_5wxv7")

[node name="head" type="Node3D" parent="." unique_id=428558243]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.575, 0)

[node name="Camera3D" type="Camera3D" parent="head" unique_id=240245589]
cull_mask = 1048573
fov = 80.0

[node name="light" type="SpotLight3D" parent="head/Camera3D" unique_id=1234205473]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.12903579, 0.11631167, -0.1840871)
spot_range = 6.64233
spot_angle = 34.493515

[node name="Node3D" type="Node3D" parent="head/Camera3D" unique_id=270514395]
transform = Transform3D(0.9999999, -1.5295811e-05, -0.00044098633, 1.4237732e-05, 0.99999714, -0.00240329, 0.00044102178, 0.0024032835, 0.999997, 0, 0.057670236, -0.050255023)

[node name="face mask" parent="head/Camera3D/Node3D" unique_id=1157816240 instance=ExtResource("4_2nftw")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8.881784e-16, -0.08140051, -0.025164045)
visible = false

[node name="Circle_002" parent="head/Camera3D/Node3D/face mask" index="2"]
surface_material_override/0 = SubResource("StandardMaterial3D_juxdh")

[node name="RayCast3D" type="RayCast3D" parent="head/Camera3D" unique_id=1068395875]
target_position = Vector3(0, 0, -2)
collide_with_areas = true

[node name="Gem holding" type="Marker3D" parent="head/Camera3D" unique_id=1687144919]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.32310176, -0.5053575, -0.6698794)

[node name="head look spot" type="Marker3D" parent="head/Camera3D" unique_id=1003638647]
transform = Transform3D(-1, -5.551115e-17, 1.4210855e-14, -1.15790496e-17, 0.9999942, 0.0033747393, 0, 0.003374739, -0.9999943, 1.2434904e-17, -0.2585435, -0.2710188)

[node name="looking direction" type="Marker3D" parent="head" unique_id=1889052025]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -1)

[node name="Radar" type="Node" parent="." unique_id=1918198491]
script = ExtResource("4_knrd4")

[node name="wrist UI" type="SubViewport" parent="Radar" unique_id=797899734]
size = Vector2i(256, 128)

[node name="VBoxContainer" type="VBoxContainer" parent="Radar/wrist UI" unique_id=715325201]
anchors_preset = 10
anchor_right = 1.0
offset_bottom = 122.0
grow_horizontal = 2
size_flags_horizontal = 4

[node name="Label" type="Label" parent="Radar/wrist UI/VBoxContainer" unique_id=1956295330]
layout_mode = 2
theme_override_font_sizes/font_size = 35
text = "Nearest target"

[node name="HBoxContainer" type="HBoxContainer" parent="Radar/wrist UI/VBoxContainer" unique_id=851936731]
layout_mode = 2
size_flags_horizontal = 4

[node name="radar target dist" type="Label" parent="Radar/wrist UI/VBoxContainer/HBoxContainer" unique_id=1269874486]
layout_mode = 2
theme_override_font_sizes/font_size = 50
text = "10"

[node name="charecter" parent="." unique_id=763800144 instance=ExtResource("2_5wxv7")]
process_mode = 3
transform = Transform3D(-1, 0, 8.742278e-08, 0, 1, 0, -8.742278e-08, 0, -1, 0, 0, 0.05)

[node name="Skeleton3D" parent="charecter/Armature" parent_id_path=PackedInt32Array(763800144, 1358612412) index="1" unique_id=1784777184]
bones/1/position = Vector3(-2.7473712e-17, -7.164889e-33, 0.7059951)
bones/7/rotation = Quaternion(0.5756228, 0.40425515, 0.5816829, -0.40851107)
bones/8/rotation = Quaternion(-0.38437915, 0.08190668, 0.053807802, 0.91795903)
bones/9/rotation = Quaternion(0.06688216, -0.0208913, -0.4116065, 0.90866417)
bones/10/rotation = Quaternion(0.05840894, -0.025488246, -0.104208596, 0.9925117)
bones/11/rotation = Quaternion(-0.5458051, -0.08376275, 0.0899736, 0.82884586)
bones/12/rotation = Quaternion(-0.31032655, -0.024309836, 0.0017544266, 0.9503175)
bones/13/rotation = Quaternion(-0.24779704, 0.0049567106, 0.036498636, 0.9681116)
bones/14/rotation = Quaternion(-0.5617538, -0.033615317, 0.08955508, 0.82175577)
bones/15/rotation = Quaternion(-0.4258976, 0.006165888, -0.013097, 0.9046556)
bones/16/rotation = Quaternion(-0.22930567, -0.0027055764, -0.026318477, 0.97299486)
bones/17/rotation = Quaternion(-0.62358254, -0.003911291, 0.009685807, 0.78168774)
bones/18/rotation = Quaternion(-0.37760034, -0.022985501, -0.020490998, 0.9254566)
bones/19/rotation = Quaternion(-0.4558843, 0.00834151, 0.014190319, 0.8898869)
bones/20/rotation = Quaternion(-0.47362882, 0.024897546, -0.09053168, 0.87570536)
bones/21/rotation = Quaternion(-0.3968003, -0.035943102, 0.010587987, 0.9171398)
bones/22/rotation = Quaternion(-0.23198655, 0.015378278, -0.003317521, 0.9725918)
bones/23/rotation = Quaternion(-0.038427945, -0.033320732, -0.6482024, 0.7597674)
bones/24/rotation = Quaternion(-0.39171842, 0.3924418, 0.12906979, 0.82212347)
bones/25/rotation = Quaternion(0.0740649, -0.15914346, 0.010686506, 0.98441535)
bones/26/position = Vector3(-0.059113726, 0.314286, 0.025670877)
bones/28/rotation = Quaternion(-0.43452942, -0.17736812, -0.22856785, 0.8529253)
bones/29/rotation = Quaternion(0.062118262, 0.021191234, 0.3822884, 0.9217093)
bones/31/rotation = Quaternion(-0.057890784, 0.027509453, -0.119810954, 0.99072564)
bones/32/rotation = Quaternion(-0.028048933, 0.022813912, -0.008577268, 0.99930936)
bones/33/rotation = Quaternion(-0.027180653, -0.012918954, -0.034493793, 0.99895173)
bones/34/rotation = Quaternion(-0.056862712, 0.027564134, -0.07340018, 0.9952986)
bones/35/rotation = Quaternion(-0.02826232, -0.0004091687, 0.014470113, 0.99949574)
bones/36/rotation = Quaternion(-0.028471997, 0.0079551, 0.025232913, 0.99924445)
bones/37/rotation = Quaternion(-0.05511722, 0.02107351, -0.0034147939, 0.99825174)
bones/38/rotation = Quaternion(-0.028417597, 0.02871906, 0.011110134, 0.9991218)
bones/39/rotation = Quaternion(-0.027985936, -0.013641534, -0.009211643, 0.99947286)
bones/40/rotation = Quaternion(-0.021438984, 0.023356728, 0.08025521, 0.99627006)
bones/41/rotation = Quaternion(-0.02734367, 0.029429473, -0.023193149, 0.9989236)
bones/42/rotation = Quaternion(0.009095501, -0.01412646, 0.0069238497, 0.9998349)
bones/43/rotation = Quaternion(-0.10747561, -0.10820765, 0.57053846, 0.80698574)
bones/44/rotation = Quaternion(-0.056225058, -0.13222636, -0.3393491, 0.92962205)
bones/45/rotation = Quaternion(0.03159734, 0.22763596, -0.048821237, 0.9720082)
bones/46/position = Vector3(0.4448517, -0.32053867, 0.16969989)
bones/47/position = Vector3(-0.00043436885, -0.07695261, -0.36490133)
bones/48/position = Vector3(-0.39925945, -0.3766271, -0.0566942)
bones/49/position = Vector3(-0.02509597, -0.21304552, -0.33280396)
bones/54/rotation = Quaternion(-0.039097615, -0.8194656, 0.20728104, 0.5328997)
bones/55/rotation = Quaternion(-0.009415471, -0.20687336, 0.065642305, 0.97611773)
bones/56/rotation = Quaternion(-0.6028576, 0.003557795, -0.07494569, 0.794313)
bones/57/rotation = Quaternion(-0.24987562, -0.00269337, 0.0015613856, 0.968273)
bones/58/rotation = Quaternion(-0.30986145, -0.109098464, 0.093730316, 0.93983936)
bones/59/rotation = Quaternion(-0.06159363, -0.5473855, 0.35563222, 0.75505036)
bones/64/rotation = Quaternion(-0.03909769, 0.81946576, -0.20728081, 0.5328995)
bones/65/rotation = Quaternion(-0.009415441, 0.20687336, -0.065642275, 0.9761178)
bones/66/rotation = Quaternion(-0.6028574, -0.0035577908, 0.07494564, 0.79431325)
bones/67/rotation = Quaternion(-0.24987537, 0.002693374, -0.001561347, 0.96827304)
bones/68/rotation = Quaternion(-0.3098616, 0.10909833, -0.09373026, 0.9398394)
bones/69/rotation = Quaternion(-0.061593976, 0.5473854, -0.35563266, 0.75505024)
bones/70/position = Vector3(-1.2149173e-10, -3.4913372e-09, 0.7059951)
bones/71/rotation = Quaternion(-0.4029899, -0.4872647, 0.51241887, 0.58103293)
bones/72/rotation = Quaternion(0.3654122, -2.2480602e-08, 2.8332146e-09, 0.93084586)
bones/73/rotation = Quaternion(-0.70325476, 2.6439583e-08, 3.6571112e-07, 0.7109379)
bones/74/rotation = Quaternion(-0.32402143, -1.0908248e-07, 2.7524914e-07, 0.9460498)
bones/75/position = Vector3(1.2149173e-10, -3.4913372e-09, 0.7059951)
bones/76/rotation = Quaternion(-0.57230043, 0.6291793, -0.322697, 0.41529787)
bones/77/rotation = Quaternion(0.0022412166, 2.417463e-08, -1.703282e-11, 0.99999756)
bones/78/rotation = Quaternion(-0.5483197, 3.4786305e-07, -1.0957649e-08, 0.8362689)
bones/79/rotation = Quaternion(-0.17053026, 1.172018e-07, -1.4481833e-07, 0.98535246)
bones/80/position = Vector3(0.1294253, 0.19661036, -0.29447258)
bones/80/rotation = Quaternion(-0.48563012, 0, 0, 0.87416446)
bones/82/position = Vector3(-0.1294253, 0.1285709, 0.2811089)
bones/82/rotation = Quaternion(-0.84998584, -4.1904225e-17, 4.1904225e-17, 0.5268056)
bones/83/rotation = Quaternion(0.7071069, -1.6064661e-16, -0.70710665, -1.6064664e-16)

[node name="head" parent="charecter/Armature/Skeleton3D" index="0" unique_id=1762230549]
transform = Transform3D(1, -1.5326814e-08, 8.606878e-08, -3.9334625e-17, 0.98451173, 0.17531829, -8.7422805e-08, -0.17531827, 0.9845118, -1.2153038e-17, 1.2592907, 3.9398268e-32)

[node name="handle" parent="charecter/Armature/Skeleton3D/head" index="0" unique_id=875156552]
transform = Transform3D(0.9892723, -0.06348905, 0.09959817, 0.10740204, 0.5906522, 4.6027424e-10, -0.099022076, 0.006354992, 0.9950277, 0.2169145, 0.26133144, -0.0039928555)

[node name="forarm_l" parent="charecter/Armature/Skeleton3D" index="1" unique_id=759532568]
transform = Transform3D(-0.354841, 0.3745438, 0.8566241, 0.528559, -0.6754026, 0.51425356, 0.77117664, 0.63525474, 0.04169195, 0.32413092, 0.9693028, -0.03958134)

[node name="MeshInstance3D" type="MeshInstance3D" parent="charecter/Armature/Skeleton3D/forarm_l" index="1" unique_id=801507463]
transform = Transform3D(-0.0011884018, -7.2313764e-05, 0.021984685, 0.031960353, 0.0006932877, 0.00081908517, -0.0010598057, 0.020988423, 4.8690476e-05, -0.0139416605, 0.17028299, 0.044341445)
mesh = SubResource("PlaneMesh_y5hcb")
surface_material_override/0 = SubResource("StandardMaterial3D_2nftw")

[node name="torso" parent="charecter/Armature/Skeleton3D" index="2" unique_id=378734934]
transform = Transform3D(1, 3.9334625e-17, 2.3841858e-07, -3.9334625e-17, 1, -9.3781054e-24, -2.3841858e-07, 0, 1, -2.7473712e-17, 0.86979485, 2.2448311e-32)

[node name="body_001" parent="charecter/Armature/Skeleton3D" index="5" unique_id=1185320111]
visible = false

[node name="ModifierBoneTarget3D" type="ModifierBoneTarget3D" parent="charecter/Armature/Skeleton3D" index="7" unique_id=1838868501]
transform = Transform3D(-0.26884997, 0.5442331, 0.79468864, -0.8108372, 0.31743845, -0.491707, -0.519868, -0.7765585, 0.35594103, -0.069894776, 1.3778491, 0.18473695)
bone_name = "breath tube.r"
bone = 6

[node name="ModifierBoneTarget3D2" type="ModifierBoneTarget3D" parent="charecter/Armature/Skeleton3D" index="8" unique_id=1905346136]
transform = Transform3D(-0.26884997, -0.5442331, -0.79468864, 0.8108372, 0.31743845, -0.491707, 0.519868, -0.7765585, 0.35594103, 0.069894776, 1.3778491, 0.18473695)
bone_name = "breath tube.l"
bone = 5

[node name="CopyTransformModifier3D" type="CopyTransformModifier3D" parent="charecter/Armature/Skeleton3D" index="9" unique_id=1193227786]
setting_count = 3
settings/0/amount = 1.0
settings/0/apply_bone_name = "hand.r"
settings/0/apply_bone = 30
settings/0/reference_type = 1
settings/0/reference_node = NodePath("")
settings/1/amount = 1.0
settings/1/apply_bone_name = "hand.l"
settings/1/apply_bone = 10
settings/1/reference_type = 1
settings/1/reference_node = NodePath("")
settings/2/amount = 0.0
settings/2/apply_bone_name = "head"
settings/2/apply_bone = 4
settings/2/reference_type = 1
settings/2/reference_node = NodePath("../../../../head/Camera3D")
settings/0/copy = 6
settings/0/axes = 7
settings/0/invert = 0
settings/0/additive = false
settings/1/copy = 6
settings/1/axes = 7
settings/1/invert = 0
settings/1/additive = false
settings/2/copy = 2
settings/2/axes = 7
settings/2/invert = 0
settings/2/additive = true

[node name="LookAtModifier3D" type="LookAtModifier3D" parent="charecter/Armature/Skeleton3D" index="10" unique_id=472549999]
target_node = NodePath("../../../../head/Camera3D/head look spot")
bone_name = "head"
bone = 4

[node name="CCDIK3D" type="CCDIK3D" parent="charecter/Armature/Skeleton3D" index="11" unique_id=404014892]
setting_count = 2
settings/0/target_node = NodePath("")
settings/1/target_node = NodePath("")
settings/0/root_bone_name = "arm.l"
settings/0/root_bone = 8
settings/0/end_bone_name = "hand.l"
settings/0/end_bone = 10
settings/0/extend_end_bone = false
settings/0/joint_count = 3
settings/1/root_bone_name = "arm.r"
settings/1/root_bone = 28
settings/1/end_bone_name = "hand.r"
settings/1/end_bone = 30
settings/1/extend_end_bone = false
settings/1/joint_count = 3
settings/0/joints/0/rotation_axis = 3
settings/0/joints/0/limitation = SubResource("JointLimitationCone3D_knrd4")
settings/0/joints/0/limitation/right_axis = 0
settings/0/joints/0/limitation/rotation_offset = Quaternion(0, 0, -0.4, 1)
settings/0/joints/1/rotation_axis = 3
settings/0/joints/1/limitation = SubResource("JointLimitationCone3D_hck1p")
settings/0/joints/1/limitation/right_axis = 0
settings/0/joints/1/limitation/rotation_offset = Quaternion(0, 0, -0.71, 1)
settings/0/joints/2/rotation_axis = 3
settings/0/joints/2/limitation = null
settings/1/joints/0/rotation_axis = 3
settings/1/joints/0/limitation = SubResource("JointLimitationCone3D_knrd4")
settings/1/joints/0/limitation/right_axis = 0
settings/1/joints/0/limitation/rotation_offset = Quaternion(0, 0, 0.4, 1)
settings/1/joints/1/rotation_axis = 3
settings/1/joints/1/limitation = SubResource("JointLimitationCone3D_juxdh")
settings/1/joints/1/limitation/right_axis = 0
settings/1/joints/1/limitation/rotation_offset = Quaternion(0, 0, 0.7, 1)
settings/1/joints/2/rotation_axis = 3
settings/1/joints/2/limitation = null

[node name="AnimationTree" type="AnimationTree" parent="charecter" unique_id=576463377]
tree_root = SubResource("AnimationNodeBlendTree_hck1p")
anim_player = NodePath("../AnimationPlayer")
parameters/Add2/add_amount = 0.041666668
parameters/Transition/current_state = "state_0"
parameters/Transition/transition_request = ""
parameters/Transition/current_index = 0
"parameters/Add2 2/add_amount" = 1.0

[node name="AudioStreamPlayer3D" type="AudioStreamPlayer3D" parent="." unique_id=882587470]
stream = ExtResource("6_hck1p")

[editable path="head/Camera3D/Node3D/face mask"]
[editable path="charecter"]
